// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Pet {
  id     Int    @id @default(autoincrement())
  name   String
  imgUrl String @map("img_url")
  stage  String
  createdAt DateTime @default(now()) @map("created_at")
  
  ownPets OwnPet[]
  
  @@map("pets")
}

model OwnPet {
  id     Int @id @default(autoincrement())
  userId Int @map("user_id")
  petId  Int @map("pet_id")
  createdAt DateTime @default(now()) @map("created_at")
  
  user User @relation(fields: [userId], references: [id])
  pet  Pet  @relation(fields: [petId], references: [id])
  
  @@map("own_pets")
}

model User {
  id       Int    @id @default(autoincrement())
  userId   String @unique @map("user_id")
  password String
  name     String
  role     String
  point    Int    @default(0)
  streak   Int    @default(0)
  createdAt DateTime @default(now()) @map("created_at")
  
  ownPets                OwnPet[]
  teacherAuthorizations  TeacherAuthorization[]
  units                  Unit[]
  unitQuestions          UnitQuestion[]
  solves                 Solve[]
  unitSolves             UnitSolve[]
  
  @@map("users")
}

model Store {
  id     Int    @id @default(autoincrement())
  name   String
  imgUrl String @map("img_url")
  price  Int
  petsId Int    @map("pets_id")
  createdAt DateTime @default(now()) @map("created_at")
  
  @@map("stores")
}

model TeacherAuthorization {
  id        Int      @id @default(autoincrement())
  teacherId Int      @map("teacher_id")
  imgUrl    String   @map("img_url")
  createdAt DateTime @default(now()) @map("created_at")
  
  teacher User @relation(fields: [teacherId], references: [id])
  
  @@map("teacher_authorizations")
}

model TeacherStudent {
  id        Int      @id @default(autoincrement())
  teacherId Int      @map("teacher_id")
  studentId Int      @map("student_id")
  createdAt DateTime @default(now()) @map("created_at")
  
  @@map("teacher_students")
}

model Unit {
  id        Int      @id @default(autoincrement())
  name      String
  vidUrl    String   @map("vid_url")
  createdAt DateTime @default(now()) @map("created_at")
  
  userId Int @map("user_id")
  user   User @relation(fields: [userId], references: [id])
  
  unitQuestions UnitQuestion[]
  
  @@map("unit")
}

model UnitQuestion {
  id         Int      @id @default(autoincrement())
  unitCode   String   @map("unit_code")
  question   String
  answer     String
  helpUrl    String   @map("help_url")
  createdAt  DateTime @default(now()) @map("created_at")
  categoryId Int      @map("category_id")
  
  unitId Int  @map("unit_id")
  unit   Unit @relation(fields: [unitId], references: [id])
  
  userId Int  @map("user_id")
  user   User @relation(fields: [userId], references: [id])
  
  @@map("unit_questions")
}

model UnitExam {
  id        Int      @id @default(autoincrement())
  code      String   @unique
  createdAt DateTime @default(now()) @map("created_at")
  teacherId Int      @map("teacher_id")
  
  unitExamAttempts UnitExamAttempt[]
  
  @@map("unit_exam")
}

model UnitExamAttempt {
  id        Int      @id @default(autoincrement())
  unitCode  String   @map("unit_code")
  studentId Int      @map("student_id")
  createdAt DateTime @default(now()) @map("created_at")
  
  unitExamId Int      @map("unit_exam_id")
  unitExam   UnitExam @relation(fields: [unitExamId], references: [id])
  
  @@map("unit_exam_attempts")
}

model Solve {
  id         Int      @id @default(autoincrement())
  question   String
  answer     String
  helpUrl    String   @map("help_url")
  userInput  String   @map("user_input")
  isCorrect  Boolean  @map("is_correct")
  createdAt  DateTime @default(now()) @map("created_at")
  categoryId Int      @map("category_id")
  userId     Int      @map("user_id")
  
  user User @relation(fields: [userId], references: [id])
  
  @@map("solves")
}

model UnitSolve {
  id         Int      @id @default(autoincrement())
  userInput  String   @map("user_input")
  isCorrect  Boolean  @map("is_correct")
  createdAt  DateTime @default(now()) @map("created_at")
  questionId Int      @map("question_id")
  userId     Int      @map("user_id")
  
  user User @relation(fields: [userId], references: [id])
  
  @@map("unit_solves")
}